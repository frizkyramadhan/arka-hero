## 2025-08-14

-   Updated `OfficialtravelController::exportExcel()` to replace deprecated recommend/approver fields with the new `approval_plans` model. Now eager-loads `approval_plans.approver` and maps latest approved plan (approver name, date, remarks). Excel headings now match row data.
-   Created `RecruitmentReportController` with comprehensive HR analytics suite. Fixed stage progression order: CV Review → Psikotes → Tes Teori → Interview → Offering → MCU → Hiring → Onboarding. Enhanced funnel report with accurate conversion rate logic, stage detail drill-down pages, Reset buttons, and fixed avg days calculation. Stage detail includes interview type column (HR/User) accessing RecruitmentInterview.type field, with proper session-to-stage relationships. Fixed interview stage counting (unique sessions vs individual interviews). Enhanced remarks column with stage-specific details: CV Review (decision + notes), Interview (result + type + notes), Psikotes (online/offline scores + result + notes), Tes Teori (score + result + notes), MCU (result + notes), Offering (letter number + response + notes), Hiring (agreement type + letter number + notes), Onboarding (date + notes). Both stage detail and aging reports use AdminLTE DataTables with Bootstrap styling, export buttons (Copy/CSV/Excel/PDF with landscape orientation/Print), sorting, pagination (25 entries), and responsive design. Stage detail has candidate names linking to recruitment sessions, aging report has request numbers linking to recruitment requests (both open in new tabs). Aging report shows approval remarks from latest approved ApprovalPlan instead of request remarks. Fixed date sorting with data-order attributes for proper chronological ordering. Uses local assets following template pattern. PDF export includes custom formatting with proper margins, header styling, and optimized font sizes for landscape A4 layout. Both reports include navigation buttons, advanced filtering, and Excel export. Implemented Time-to-Hire Analysis report with comprehensive metrics: total days (request to hiring), approval days (request to approval), recruitment days (approval to hiring). Features include date range filtering, department/position/project filters, summary dashboard with averages, color-coded badges for performance indicators, DataTable with export functionality, and request number links to detail pages. Report calculates actual time differences between key milestones using proper date arithmetic. Fixed relationship error by using correct 'sessions' relationship instead of 'recruitmentSessions' in RecruitmentRequest model.

## 2025-08-15 - Time-to-Hire Report UI Consistency & Funnel Report Enhancements

-   **Time-to-Hire Report UI Consistency**: Updated Time-to-Hire report layout to match other reports. Moved "Back to Reports" button to header right side, integrated filters directly in card-header (removing separate filter section), moved summary boxes inside card-body, and standardized table styling with `table-sm table-bordered table-striped` classes. Removed breadcrumb navigation in favor of consistent button placement.
-   **Funnel Report Result Mapping**: Enhanced stage detail report for 'hiring' and 'onboarding' stages to automatically map "Pending" and "In Progress" results to "Hired" and "Complete" respectively. This provides more meaningful status information for final recruitment stages.
-   **Controller Improvements**: Updated `RecruitmentReportController::timeToHire()` and `exportTimeToHire()` methods to handle empty date filters gracefully. Date filtering now only applies when both date1 and date2 are provided, allowing reports to show all data when no date range is specified.
-   **Data Consistency**: Ensured Time-to-Hire report includes `session_id` for proper linking to recruitment session details, maintaining consistency with other reports' navigation patterns.
-   **Offer Acceptance Rate Report**: Implemented comprehensive report for tracking offer acceptance/rejection rates and response times. Features include: summary dashboard (Total Offers, Accepted, Rejected, Pending), detailed table with candidate information, offering dates, response times, and status tracking. Report calculates response time in days with color-coded badges (≤3 days: green, ≤7 days: yellow, >7 days: red). Includes DataTable functionality with export options (Copy, CSV, Excel, PDF landscape, Print), filtering by date range, department, position, and project. **Request No** links to recruitment session details (candidate name is display-only). Uses consistent AdminLTE styling and layout patterns matching other reports. Includes debug information to verify data availability and troubleshoot empty date fields.

## 2025-08-13 - Officialtravel API alignments with Approval Plan

-   Controller `OfficialtravelApiController` fixed invalid `whereNot` usage to `where('<>')`.
-   Introduced `search_claimable` endpoint: finished trips (`departure_from_destination` not null) and not yet claimed.
-   `search_claimed` now correctly returns already claimed records.
-   `updateClaim` now sets `claimed_at` only when claiming (`yes`), resets to null when unclaiming.
-   Model `Officialtravel::approval_plans()` scoped by `document_type = 'officialtravel'`.
-   Resource `OfficialtravelResource` now exposes `approval_plans` including approver info for API consumers.
